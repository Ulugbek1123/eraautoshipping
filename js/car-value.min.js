$(document).ready((function(){async function e(e){const a=await $.ajax({url:"https://vpic.nhtsa.dot.gov/api/vehicles/DecodeVinValues/"+e+"?format=json",type:"GET",success:function(e){if("0"==e.Results[0].ErrorCode){$(".wrong-vin").addClass("d-none"),a=e.Results[0].Make,t=e.Results[0].Model,i=e.Results[0].ModelYear,$("#car-year").removeAttr("disabled"),$("#car-make").removeAttr("disabled"),$("#car-model").removeAttr("disabled"),$("#car-year").val(i),$("#car-make").val(a),$("#car-model").val(t);let l=$(".steps .tab-pane.step-tab.active"),r=$(".car-img .active");l.removeClass("active"),l.next().tab("show"),r.removeClass("active show animate__fadeIn").addClass("animate__fadeOut").next().removeClass("animate__fadeOut").addClass("active show animate__fadeIn")}else $(".wrong-vin").removeClass("d-none");var a,t,i},error:function(){$(".wrong-vin").removeClass("d-none")}});return $(".car-value-widget .first-next-btn").removeClass("d-none"),$(".car-value-widget .vin-check-btn").addClass("d-none"),a}function a(){var e=[];$.get(window.NEXUS_API_URL+"/api/vehicles/years").done((function(a){a.data.forEach(a=>{e.push(a)})})).fail((function(){alertify.alert("Error","Something went wrong. Please try again later.")}));let a=new autoComplete({selector:"#car-year",data:{src:e},resultItem:{highlight:!0},events:{input:{selection:e=>{const t=e.detail.selection.value;a.input.value=t,$("#car-make").val(""),$("#car-model").val(""),$("#car-make").removeAttr("disabled"),$("#car-make").attr("placeholder","Car Make")}}}})}function t(){var e=[],a={};$.get(window.NEXUS_API_URL+"/api/vehicles/makes").done((function(t){t.data.forEach(t=>{e.push(t.name),a['"'+t.name+'"']=t.id})})).fail((function(){alertify.alert("Error","Something went wrong. Please, try again later.")}));let t=new autoComplete({selector:"#car-make",data:{src:e,filter:e=>e.filter(e=>{const a=t.input.value.toLowerCase();if(e.value.toLowerCase().startsWith(a))return e.value})},resultItem:{highlight:!0},events:{input:{selection:e=>{const i=e.detail.selection.value;t.input.value=i;var l=$("#car-year").val()||"";$("#car-model").val(""),$("#car-model").removeAttr("disabled"),$("#car-model").attr("placeholder","Car Model"),function(e,a){var t=[];$.get(window.NEXUS_API_URL+"/api/vehicles",{year:e,vehicle_make_id:a}).done((function(e){e.data.forEach(e=>{t.push(e.model)})})).fail((function(){alertify.alert("Error","Something went wrong. Please, try again later.")}));let i=new autoComplete({selector:"#car-model",data:{src:t,filter:e=>e.filter(e=>{const a=i.input.value.toLowerCase();if(e.value.toLowerCase().startsWith(a))return e.value})},resultItem:{highlight:!0},events:{input:{selection:e=>{const a=e.detail.selection.value;i.input.value=a}}}})}(l,a['"'+i+'"'])}}}})}$(window).resize((function(){windowsize=$(window).width(),windowsize>991?$(".show-focus").addClass("d-none"):($(".show-focus").removeClass("d-none"),$(".car-value-widget").prependTo(".widget-buttons"))})),$(window).scroll((function(){$(window).scrollTop()>=450&&$(window).width()>991?$(".car-value-widget").prependTo(".entry-titles-wrapper"):$(".car-value-widget").prependTo(".widget-buttons")})),$("#car-year").focus((function(){$(".show-focus").removeClass("d-none")})),$(window).width()<=991&&$(".show-focus").removeClass("d-none"),$(".sell-cta").click((function(e){e.preventDefault(),$("html, body").animate({scrollTop:$(".cv-widget").offset().top-100},1e3),$("#car-year").focus()})),$(".car-value-widget #car-year").on("change input",(function(){4==$(this).val().length?($(".car-value-widget #car-make").removeAttr("disabled"),$(".car-value-widget #car-make").attr("placeholder","Vehicle Make")):($(".car-value-widget #car-make").attr("disabled",!0),$(".car-value-widget #car-make").attr("placeholder","Fill Year First"))})),$(".car-value-widget #car-make").on("change input",(function(){$(this).val().length?($(".car-value-widget #car-model").removeAttr("disabled"),$(".car-value-widget #car-model").attr("placeholder","Vehicle Model")):($(".car-value-widget #car-model").attr("disabled",!0),$(".car-value-widget #car-model").val(""),$(".car-value-widget #car-model").attr("placeholder","Fill Year and Model"))})),$(".car-value-widget .start").click((function(){$(".car-value-widget .car-value").addClass("expand"),$("#step-1").removeClass("active"),$("#step-2").tab("show"),$(".car-value .buying").remove(),new IMask($("#phone")[0],{mask:"(000) 000-0000"}),a(),t()})),$(".car-value-widget .start-buy").click((function(){$(".car-value-widget .car-value").addClass("expand"),$(".car-value-widget .buying").removeClass("d-none"),$(".car-value .selling").remove(),new IMask($("#phone")[0],{mask:"(000) 000-0000"}),a(),t()})),$(".car-value-widget .next").click((function(){let a=$(".steps .tab-pane.step-tab.active"),t=$(".car-img .active");var i,l,r,n,s,c,o,d,v,u,m,h,w,p,f;$("html,body").animate({scrollTop:0},300),$("#carvalue").validate({rules:{vinnumber:{required:!0},year:{required:!0},make:{required:!0},model:{required:!0},zip:{required:!0},milage:{required:!0},color:{required:!0},transmission:{required:!0},"exterior-condition":{required:!0},"interior-condition":{required:!0},modifications:{required:!0},accidents:{required:!0},title:{required:!0},cvemail:{required:!0,email:!0},cvphone:{required:!0}}}),$("#carvalue").valid()&&($(this).hasClass("finish")?($(".last-form").addClass("d-none"),$(".finish-text").removeClass("d-none"),i=$("#email").val(),l=$("#phone").val().replace(/[^0-9]/g,""),r=$("#vinnumber").val(),n=$("#car-year").val(),s=$("#car-make").val(),c=$("#car-model").val(),o=$("#zip").val(),d=$("#milage").val(),v=$("#color").val(),u=$("[name='transmission']:checked").val(),m=$("[name='exterior-condition']:checked").val(),h=$("[name='interior-condition']:checked").val(),w="yes"==$("[name='modifications']:checked").val()?1:0,p="yes"==$("[name='accidents']:checked").val()?1:0,f=$("[name='title']:checked").val(),$.ajax({type:"POST",url:window.NEXUS_API_URL+"/api/web/vehicle-resale/sell",headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"},data:{vin:r,year:n,make:s,model:c,zip:o,mileage:d,color:v,transmission:u,exterior_condition:m,interior_condition:h,modifications:w,accidents:p,title:f,email:i,phone:l},success:function(){console.log("success"),gtag("event","conversion",{send_to:"AW-941490390/zB4aCIjhmI0YENaB-MAD"})}})):$("#step-2").hasClass("active")&&$("#vin-tab").hasClass("active")?($(".car-value-widget .first-next-btn").addClass("d-none"),$(".car-value-widget .vin-check-btn").removeClass("d-none"),e($("#vinnumber").val())):(a.removeClass("active"),a.next().tab("show"),t.removeClass("active show animate__fadeIn").addClass("animate__fadeOut").next().removeClass("animate__fadeOut").addClass("active show animate__fadeIn")))})),$(".car-value-widget .next-buy").click((function(){let a=$(".buying .steps .tab-pane.step-tab.active"),t=$(".car-img .active");if($("html,body").animate({scrollTop:0},300),$("#carvalue-buying").validate({rules:{year:{required:!0},make:{required:!0},model:{required:!0},maxprice:{required:!0},color:{required:!0},transmission:{required:!0},"fuel-type":{required:!0},cvemail:{required:!0,email:!0},cvphone:{required:!0},cvzipcode:{required:!0}}}),$("#carvalue-buying").valid())if($(this).hasClass("finish")){$(".car-value-widget .car-value").addClass("finished"),$(".steps .tab-pane.active").removeClass("active"),function(){var e=$("#email").val(),a=$("#phone").val().replace(/[^0-9]/g,""),t=$("#zipcode").val(),i=$("#car-year").val(),l=$("#car-make").val(),r=$("#car-model").val(),n=$("#milage").val(),s=$("#maxprice").val(),c=$("#color").val(),o=$("[name='transmission']:checked").val(),d=$("[name='vehicletype']:checked").val(),v=$("[name='vehiclecondition']:checked").val(),u=$("[name='fuel-type']:checked").val();i&&l&&r&&(d="");$.ajax({type:"POST",url:window.NEXUS_API_URL+"/api/web/vehicle-resale/buy",headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"},data:{year:i,make:l,model:r,mileage:n,color:c,price:s,transmission:o,vehicle_type:d,vehicle_condition:v,fuel_type:u,email:e,phone:a,zip:t},success:function(){console.log("success")}})}()}else $("#step-2").hasClass("active")&&$("#vin-tab").hasClass("active")?($(".car-value-widget .first-next-btn").addClass("d-none"),$(".car-value-widget .vin-check-btn").removeClass("d-none"),e($("#vinnumber").val())):(a.removeClass("active"),a.next().tab("show"),t.removeClass("active show animate__fadeIn").addClass("animate__fadeOut").next().removeClass("animate__fadeOut").addClass("active show animate__fadeIn"))})),$(".car-value-widget .vehicle-type").click((function(){$(".search-vehicle-model").addClass("d-none"),$(".search-vehicle-type").removeClass("d-none")})),$(".car-value-widget .vehicle-model").click((function(){$(".search-vehicle-model").removeClass("d-none"),$(".search-vehicle-type").addClass("d-none")})),$(".car-value-widget .back").click((function(){let e=$(".steps .tab-pane.step-tab.active"),a=$(".car-img .active");$("html,body").animate({scrollTop:0},300),e.removeClass("active"),e.prev().tab("show"),a.removeClass("active show animate__fadeIn").addClass("animate__fadeOut").prev().removeClass("animate__fadeOut").addClass("active show animate__fadeIn")})),$(".car-value-widget .back-buy").click((function(){let e=$(".steps .tab-pane.step-tab.active"),a=$(".car-img .active");$("html,body").animate({scrollTop:0},300),e.removeClass("active"),e.prev().tab("show"),a.removeClass("active show animate__fadeIn").addClass("animate__fadeOut").prev().removeClass("animate__fadeOut").addClass("active show animate__fadeIn")})),$(".car-value-widget .hide-widget").click((function(){$(".car-value-widget").slideUp()})),$(".car-value-widget .reset-widget").click((function(){location.reload();let e=$(".steps .tab-pane.step-tab.active"),a=$(".car-img .active");e.removeClass("active"),$(".car-value-widget .car-value").removeClass("finished"),a.removeClass("active show animate__fadeIn").addClass("animate__fadeOut"),$("#carvalue")[0].reset(),$(".firstcar").removeClass("animate__fadeOut").addClass("active show animate__fadeIn"),$("#step-2").removeClass("active").tab("show"),$("#novin-tab").removeClass("active").tab("show")}))}));