var placesCallback;const locations={pickup:null,pickup_city:null,pickup_zip:null,delivery:null,delivery_city:null,delivery_zip:null};$(".calculator").ready((function(){$(".calculator .cstep-1 .dropdown-toggle").on("click",(function(t){t.stopPropagation(),t.preventDefault();var e=$(this);$(".calculator .cstep-1 .dropdown-toggle").not(e).closest(".dropdown").find(".dropdown-menu:visible").stop(!0,!0).slideUp(250,(function(){$(window).width()<768?$(this).closest(".dropdown").find(".popup-bg").fadeOut(250,(function(){$(this).closest(".dropdown").removeClass("show")})):$(this).closest(".dropdown").removeClass("show")}));var i=e.closest(".dropdown");i.hasClass("show")?i.find(".dropdown-menu").first().stop(!0,!0).slideUp(250,(function(){$(window).width()<768?i.find(".popup-bg").fadeOut(250,(function(){i.removeClass("show")})):i.removeClass("show")})):i.find(".dropdown-menu").first().find(".dropdown-item").length>0&&(i.addClass("show"),i.find(".popup-bg").fadeIn(250),i.find(".dropdown-menu").first().stop(!0,!0).slideDown(250))})),$(".calculator .dropdown .dropdown-item").on("click",(function(t){var e=$(this).closest(".dropdown"),i=$(this);if(i.is(".datepicker-item")&&t.stopPropagation(),i.is(".more-vehicle"))return t.stopPropagation(),i.hide(),i.siblings(".dropdown-item:hidden").fadeIn(100),!1;e.find(".dropdown-menu").first().stop(!0,!0).slideUp(250,(function(){i.is(".datepicker-item")?(e.find("input.time").datepicker("widget").insertAfter(e.find(".dropdown-menu").first()),e.find("input.time").datepicker("show")):$(window).width()<768?e.find(".popup-bg").fadeOut(250,(function(){e.removeClass("show")})):e.removeClass("show")}))})),$(document).on("click",(function(t){$(t.target).is(".dropdown-toggle")||$(".dropdown-menu:visible").stop(!0,!0).slideUp(250,(function(){$(window).width()<768?$(this).closest(".popup-bg").fadeOut(250,(function(){$(this).closest(".dropdown").removeClass("show")})):$(this).closest(".dropdown").removeClass("show")}))})),$(".modal-toggle").click((function(t){$($(this).data("target")).toggleClass("shown")})),jQuery("img.svg").each((function(){var t=jQuery(this),e=t.attr("id"),i=t.attr("class"),o=t.attr("src");jQuery.get(o,(function(o){var n=jQuery(o).find("svg");void 0!==e&&(n=n.attr("id",e)),void 0!==i&&(n=n.attr("class",i+" replaced-svg")),n=n.removeAttr("xmlns:a"),t.replaceWith(n)}),"xml")})),$(".calculator .cstep-1 input.time").each((function(t,e){$(e).datepicker({showAnim:"slideDown",duration:250,minDate:0,showOn:"none",onSelect:function(t,e){$(this).val();setTimeout((function(){$(this).closest(".dropdown").removeClass("show")}),250)},onClose:function(t,e){$(this).val();var i=$(this);setTimeout((function(){i.closest(".dropdown").removeClass("show")}),250)}})})),$(".calculator .dropdown.act-as-combobox .dropdown-menu").not(".more-vehicle").bind("click",(function(t){if(0==$(t.target).is(".dropdown-item")||$(t.target).is(".datepicker-item"))return;const e=$(t.target);let i=e.attr("data-key"),o=e.contents().filter((function(){return this.nodeType==Node.TEXT_NODE})).text().trim();null!=o&&null!=o&&""!=o||(o=e.children().contents().filter((function(){return this.nodeType==Node.TEXT_NODE})).text().trim());let n=e.closest(".dropdown").find("input").first();n.val(o),n.attr("data-key",i)})),$(".calculator .cstep-1 .dropdown.size-of-car .dropdown-item").bind("click",(function(){$(this).siblings(".dropdown-item.selected").removeClass("selected"),$(this).addClass("selected")}));var t=null;function e(t){if(t){var e=new Date(t),i=""+(e.getMonth()+1),o=""+e.getDate(),n=e.getFullYear();return i.length<2&&(i="0"+i),o.length<2&&(o="0"+o),[n,i,o].join("-")}return null}$(".address_input").on("input",(function(){let e=$(this);if($(this).addClass("fill"),$(this).parents(".form-group").first().addClass("fill"),e.val()){t&&t.abort();let i=e.siblings(".list-group");t=$.get(`${window.NEXUS_API_URL}/api/locations?q=${e.val()}`,(function(t){i.html(""),t.data.map((t,i)=>{i<5&&e.hasClass("fill")&&(t.zip?e.siblings(".list-group").append(`<div type="button" class="list-group-item list-group-item-action text-left border-0"><p>${t.zip}, ${t.city}, ${t.state}</p></div>`):e.siblings(".list-group").append(`<div type="button" class="list-group-item list-group-item-action text-left border-0"><p>${t.city}, ${t.state}</p></div>`))})}))}})),$(document).click((function(t){if($(".form-group.fill").length){let e=$(t.target).parents(".list-group").first().siblings(".address_input").first();$(t.target).hasClass("list-group-item")||$(t.target).parent("div").first().hasClass("list-group-item")?(e.attr("data-selected",$(t.target).text()),e.val($(t.target).text()),function(t,e){let i=t.split(", "),o=i[i.length-1].toLowerCase();o="dic"==o?"dc":o,locations[e]=o,locations[e+"_city"]=i[1],locations[e+"_zip"]=i[0]}($(t.target).text(),e.attr("name")),$(t.target).parents(".list-group").html("")):($("input.fill").val(""),$("input.fill").attr("data-selected",""),$(".list-group").html("")),$(".address_input").each((function(){$(this).removeClass("fill"),$(this).parents(".form-group").first().removeClass("fill")}))}})),$(".calculator .cstep-1 .tab-select-route").click((function(){var t=$(this);t.next(".tab-track-shipment").removeClass("active"),t.addClass("active"),t.siblings("form.track-shipment").first().not(".calculator .cstep-1 form.track-shipment>img").fadeOut(50,(function(){t.siblings("form.select-route").first().fadeIn()}))})),$(".calculator .cstep-1 .tab-track-shipment").click((function(){var t=$(this);t.prev(".tab-select-route").removeClass("active"),t.addClass("active"),t.siblings("form.select-route").first().fadeOut(50,(function(){t.siblings("form.track-shipment").first().not(".calculator .cstep-1 form.track-shipment>img").fadeIn()}))})),$(window).on("resize",(function(){var t=$(".calculator .cstep-1 .dropdown.time").find(".dropdown-menu"),e=$(".calculator .cstep-1 .dropdown.size-of-car").find(".dropdown-menu"),i=e.parent(".popup-bg");$(window).width()<768?0==i.length&&(t.wrap('<div class="popup-bg"></div>'),e.wrap('<div class="popup-bg"></div>'),$(".calculator .cstep-1 .dropdown .popup-bg").prepend('<div class="btn-close" />')):($(".calculator .cstep-1 .dropdown .popup-bg .btn-close").remove(),0!=i.length&&(t.unwrap(),e.unwrap()))})),$(window).trigger("resize"),$(".calculator .cstep-1 .popup-bg").bind("click",(function(t){t.stopPropagation(),t.preventDefault()})),$(".calculator .cstep-1 .popup-bg .btn-close").bind("click",(function(){$(document).trigger("click")})),$(".calculator .cstep-1 form.select-route").on("submit",(function(t){t.preventDefault();let i=$("input[name='time']").val(),o=null;"As soon as possible"!=i&&"Within 7 days"!=i&&"I don't know yet"!=i&&(o=i,i="On a particular date");let n={url:window.NEXUS_API_URL+"/api/web/calculator",method:"POST",timeout:0,headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"},data:{pickup_address:$("input[name='pickup']").val(),delivery_address:$("input[name='delivery']").val(),pickup_time:i,vehicle_type:$("input[name='vehicle']").attr("data-key"),pickup_date:e(o)}};$.ajax(n).done((function(t){let e={id:t.data.result.calculation_id,from:locations.pickup,from_city:locations.pickup_city,from_zip:locations.pickup_zip,to:locations.delivery,to_city:locations.delivery_city,to_zip:locations.delivery_zip,time:t.data.query.pickup_date||t.data.query.pickup_time,vehicle:$("input[name='vehicle']").val(),quote:{...t.data.result.quote}};localStorage.setItem("calculation",JSON.stringify(e)),"/"===window.location.pathname?window.location.assign("./calculator/reserve"):window.location.assign("/calculator/reserve")})).fail((function(t,e){alertify.alert("Error","Error calculating route, please try again."),errorCallback&&errorCallback()}))}))}));